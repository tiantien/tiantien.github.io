(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{317:function(s,e,t){"use strict";t.r(e);var a=t(5),n=Object(a.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"secret"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#secret"}},[s._v("#")]),s._v(" Secret")]),s._v(" "),e("h2",{attrs:{id:"概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[s._v("#")]),s._v(" 概述")]),s._v(" "),e("p",[s._v("Kubernetes "),e("code",[s._v("Secret")]),s._v(" 对象可以用来储存敏感信息，例如：密码、OAuth token、ssh 密钥等。如果不使用 "),e("code",[s._v("Secret")]),s._v("，此类信息可能被放置在 Pod 定义中或者容器镜像中。将此类敏感信息存储到 "),e("code",[s._v("Secret")]),s._v(" 中，可以更好地：")]),s._v(" "),e("ul",[e("li",[s._v("控制其使用")]),s._v(" "),e("li",[s._v("降低信息泄露的风险")])]),s._v(" "),e("p",[s._v("用户可以直接创建 Secret，Kubernetes 系统也会创建一些 Secret。")]),s._v(" "),e("p",[s._v("Secret有如下几种使用方式：")]),s._v(" "),e("ul",[e("li",[s._v("作为 Pod 的数据卷挂载")]),s._v(" "),e("li",[s._v("作为 Pod 的环境变量")]),s._v(" "),e("li",[s._v("kubelet 在抓取容器镜像时，作为 docker 镜像仓库的用户名密码")])]),s._v(" "),e("h2",{attrs:{id:"内建secret"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#内建secret"}},[s._v("#")]),s._v(" 内建Secret")]),s._v(" "),e("h2",{attrs:{id:"自建secret"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自建secret"}},[s._v("#")]),s._v(" 自建Secret")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl create secret docker-registry registry-habor-secret "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--docker-server"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("repository.pingtanii.com --docker-username"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin --docker-password"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("FueTnK6\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"查看secret"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看secret"}},[s._v("#")]),s._v(" 查看Secret")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 检查 Secret 的创建结果")]),s._v("\nkubectl get secret\nNAME                    TYPE                                  DATA   AGE\ndefault-token-rqr5t     kubernetes.io/service-account-token   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("      122d\nregistry-habor-secret   kubernetes.io/dockerconfigjson        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      122d\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看 Secret 详情")]),s._v("\nkubectl describe secrets registry-habor-secret\nName:         registry-habor-secret\nNamespace:    ledger\nLabels:       "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nAnnotations:  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\nType:  kubernetes.io/dockerconfigjson\n\nData\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n.dockerconfigjson:  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("116")]),s._v(" bytes\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看 Secret 详情 Yaml格式")]),s._v("\nkubectl get secret registry-habor-secret --output"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yaml\napiVersion: v1\ndata:\n  .dockerconfigjson: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("eyJhdXRocyI6eyJyZXBvc2l0b3J5LnBpbmd0YW5paS5jb20iOnsidXNlcm5hbWUiOiJhZG1pbiIsInBhc3N3b3JkIjoiXHUwMDI2RnVlVG5LNiIsImF1dGgiOiJZV1J0YVc0NkprWjFaVlJ1U3pZPSJ9fX0")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\nkind: Secret\nmetadata:\n  creationTimestamp: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022-02-11T02:04:44Z"')]),s._v("\n  name: registry-habor-secret\n  namespace: ledger\n  resourceVersion: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1239917"')]),s._v("\n  uid: ac6b07b1-98f8-446b-958b-e9c277f76d17\ntype: kubernetes.io/dockerconfigjson\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 解码")]),s._v("\nkubectl get secret registry-habor-secret --output"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jsonpath={.data.\\.dockerconfigjson}"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" base64 --decode\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"auths"')]),s._v(":"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repository.pingtanii.com"')]),s._v(":"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token entity",title:"\\u0026"}},[s._v("\\u0026")]),s._v('FueTnK6"')]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"auth"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"YWRtaW46JkZ1ZVRuSzY="')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br")])]),e("h2",{attrs:{id:"编辑secret"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编辑secret"}},[s._v("#")]),s._v(" 编辑Secret")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl edit secrets registry-habor-secret\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])}),[],!1,null,null,null);e.default=n.exports}}]);